

### SVD/SVD++实现排序



#### 数据分析：

###### 利用已有的不同user对不同movie的评分，可以得到一个user与movie的数据矩阵，这是一个及其稀疏的矩阵，单纯使用协同过滤可能会很大程度受到稀疏的影响，故考虑使用SVD协同过滤，这其实算是协同过滤+基于内容推荐的融合的向量化表示。在该分解模型中，主要训练的参数即用户隐因子矩阵与电影隐因子矩阵，分别对应了用户与电影的特征。



#### SVD：

###### 基本公式：

<img src="https://images0.cnblogs.com/blog2015/674428/201505/221605256508750.png" alt="技术分享" style="zoom:67%;" />

###### 其中，p~u~代表用户隐因子矩阵 ，q~i~代表电影隐因子矩阵。



###### 优化函数：

<img src="https://images0.cnblogs.com/blog2015/674428/201505/221605382606403.png" alt="技术分享" style="zoom: 50%;" />



###### 利用随机梯度下降算法更新参数：

<img src="https://images2018.cnblogs.com/blog/772139/201804/772139-20180419090221181-1881697690.png" alt="img" style="zoom:50%;" />



#### SVD++：

###### 基本公式：SVD++算法是指在SVD的基础上引入隐式反馈，使用用户的历史浏览数据、用户历史评分数据等作为新的参数。

<img src="https://images2018.cnblogs.com/blog/772139/201804/772139-20180419101958225-839003370.png" alt="img" style="zoom:50%;" />

###### SVD++算法是指在SVD的基础上引入隐式反馈，使用用户的历史浏览数据、用户历史评分数据等作为新的参数。这里的N(u)表示用户u行为记录（包括浏览的和评过分的商品集合），yj为隐藏的“评价了电影 j”反映出的个人喜好偏置。其他参数同SVD中的参数含义一致。



###### 利用随机梯度下降算法更新参数：

<img src="https://images2018.cnblogs.com/blog/772139/201804/772139-20180419102607365-104321270.png" alt="img" style="zoom:50%;" />



#### 数据结果记录：

| 模型  | 训练周期数 | 隐因子个数 | NDCG  | 时长   |
| ----- | ---------- | ---------- | ----- | ------ |
| SVD   | 130        | 30         | 0.817 | 2分钟  |
| SVD   | 115        | 50         | 0.825 | 2分钟  |
| SVD   | 88         | 140        | 0.824 | 1分钟+ |
| SVD   | 80         | 180        | 0.829 | 1分钟+ |
| SVD++ | 130        | 30         | 0.812 | 3小时  |

